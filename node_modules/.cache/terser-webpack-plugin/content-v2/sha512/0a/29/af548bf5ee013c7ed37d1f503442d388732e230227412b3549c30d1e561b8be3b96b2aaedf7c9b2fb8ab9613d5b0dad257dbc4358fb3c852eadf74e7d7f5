{"code":"!function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&r&&\"string\"!=typeof e)for(var o in e)t.d(n,o,function(t){return e[t]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,\"a\",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p=\"\",t(t.s=3)}([function(e){const t=128;e.exports={flatten:function(e){return e.reduce((e,t)=>e.concat(t),[])},serializeDescriptors:function(e){return e.map(e=>({className:e.className,faceDescriptors:e.faceDescriptors.map(e=>e.getData())}))},toDescriptorState:function(e){return e.map(e=>({className:e.className,numFaces:e.faceDescriptors.length}))},makeLoadDescriptors:function(e){return function(r){return function(e){e.forEach(e=>{if(!e.className)throw new Error(\"import - expected a class name for every group of descriptors\");if(!e.faceDescriptors.every(e=>e.length===t))throw new Error(`import - expected every descriptor to have ${t} entries`)})}(r),r.map(t=>({className:t.className,faceDescriptors:t.faceDescriptors.map(t=>new e.Array(t))}))}},makeComputeMeanDistance:function(e){return function(t,r){return function(e,t=2){const r=Math.pow(10,t);return Math.round(e*r)/r}(t.map(t=>e.distance(t,r)).reduce((e,t)=>e+t,0)/(t.length||1))}},makeGetJitteredFaces:function(e){return function(t,r){if(r&&t.rows!==t.cols)throw new Error(\"jittering requires the face to have the same number of rows and cols\");return[t].concat(r?e.jitterImage(t,r):[])}},makeAddFaceDescriptors:function(e){return function(t,r){const n=e.findIndex(e=>e.className===r);return-1===n?void e.push({className:r,faceDescriptors:t}):void(e[n].faceDescriptors=e[n].faceDescriptors.concat(t))}},getBestPrediction:function(e,t){const r=e.sort((e,t)=>e.distance-t.distance)[0];return t&&r.distance>=t&&(r.className=\"unknown\"),r}}},function(e){function t(){throw new Error(\"setTimeout has not been defined\")}function r(){throw new Error(\"clearTimeout has not been defined\")}function n(e){if(s===setTimeout)return setTimeout(e,0);if((s===t||!s)&&setTimeout)return s=setTimeout,setTimeout(e,0);try{return s(e,0)}catch(t){try{return s.call(null,e,0)}catch(t){return s.call(this,e,0)}}}function o(){d&&l&&(d=!1,l.length?p=l.concat(p):m=-1,p.length&&c())}function c(){if(!d){var e=n(o);d=!0;for(var t=p.length;t;){for(l=p,p=[];++m<t;)l&&l[m].run();m=-1,t=p.length}l=null,d=!1,function(e){if(u===clearTimeout)return clearTimeout(e);if((u===r||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(e);try{u(e)}catch(t){try{return u.call(null,e)}catch(t){return u.call(this,e)}}}(e)}}function i(e,t){this.fun=e,this.array=t}function a(){}var s,u,f=e.exports={};!function(){try{s=\"function\"==typeof setTimeout?setTimeout:t}catch(e){s=t}try{u=\"function\"==typeof clearTimeout?clearTimeout:r}catch(e){u=r}}();var l,p=[],d=!1,m=-1;f.nextTick=function(e){var t=Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];p.push(new i(e,t)),1!==p.length||d||n(c)},i.prototype.run=function(){this.fun.apply(null,this.array)},f.title=\"browser\",f.browser=!0,f.env={},f.argv=[],f.version=\"\",f.versions={},f.on=a,f.addListener=a,f.once=a,f.off=a,f.removeListener=a,f.removeAllListeners=a,f.emit=a,f.prependListener=a,f.prependOnceListener=a,f.listeners=function(){return[]},f.binding=function(){throw new Error(\"process.binding is not supported\")},f.cwd=function(){return\"/\"},f.chdir=function(){throw new Error(\"process.chdir is not supported\")},f.umask=function(){return 0}},function(e){e.exports=function(e,t){return function(){return new e.ShapePredictor(t)}}},function(e,t,r){r(4)},function(e,t,r){(function(t){let n=t.env.BINDINGS_DEBUG?r(!function(){var e=new Error(\"Cannot find module '../build/Debug/facerec'\");throw e.code=\"MODULE_NOT_FOUND\",e}()):r(!function(){var e=new Error(\"Cannot find module '../build/Release/facerec'\");throw e.code=\"MODULE_NOT_FOUND\",e}());const o=r(5);n=o(n);const c=r(6);Object.assign(n,r(8)(n,c.faceDetectionModel,c.faceLandmarks5Model,c.faceLandmarks68Model)),Object.assign(n,r(11)(n,c.faceRecognitionModel)),n.FaceLandmark5Predictor=r(2)(n,c.faceLandmarks5Model),n.FaceLandmark68Predictor=r(2)(n,c.faceLandmarks68Model),n.winKillProcessOnExit=function(){\"win32\"===t.platform&&(t.on(\"exit\",e=>{0===e&&t.kill(t.pid)}),t.on(\"SIGINT\",()=>{t.kill(t.pid)}))},n.withCv=function(e){return Object.assign({},n,r(14)(n,e))},e.exports=n}).call(this,r(1))},function(e){const t=e=>\"function\"==typeof e,r=e=>e.prototype.constructor.name.endsWith(\"Async\"),n=e=>(function(){return t(arguments[arguments.length-1])?e.apply(this,arguments):new Promise((t,r)=>{const n=Array.prototype.slice.call(arguments);n.push(function(e,n){return e?r(e):t(n)});try{e.apply(this,n)}catch(e){return r(e)}})});e.exports=(e=>{const o=Object.keys(e).filter(r=>t(e[r])).map(t=>e[t]),c=o.filter(r);return o.filter(e=>!!Object.keys(e.prototype).length).forEach(e=>{Object.keys(e.prototype).filter(t=>r(e.prototype[t])).forEach(t=>e.prototype[t]=n(e.prototype[t]))}),c.forEach(t=>{e[t.prototype.constructor.name]=n(t)}),e})},function(e,t,r){(function(t){const n=r(7),o=n.resolve(t,\"models\");e.exports={faceLandmarks5Model:n.resolve(o,\"shape_predictor_5_face_landmarks.dat\"),faceLandmarks68Model:n.resolve(o,\"shape_predictor_68_face_landmarks.dat\"),faceDetectionModel:n.resolve(o,\"mmod_human_face_detector.dat\"),faceRecognitionModel:n.resolve(o,\"dlib_face_recognition_resnet_model_v1.dat\")}}).call(this,\"/\")},function(e,t,r){(function(e){function r(e,t){for(var r,n=0,o=e.length-1;0<=o;o--)\".\"===(r=e[o])?e.splice(o,1):\"..\"===r?(e.splice(o,1),n++):n&&(e.splice(o,1),n--);if(t)for(;n--;n)e.unshift(\"..\");return e}function n(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}var o=/^(\\/?|)([\\s\\S]*?)((?:\\.{1,2}|[^\\/]+?|)(\\.[^.\\/]*|))(?:[\\/]*)$/,c=function(e){return o.exec(e).slice(1)};t.resolve=function(){for(var t,o=\"\",c=!1,i=arguments.length-1;-1<=i&&!c;i--){if(\"string\"!=typeof(t=0<=i?arguments[i]:e.cwd()))throw new TypeError(\"Arguments to path.resolve must be strings\");t&&(o=t+\"/\"+o,c=\"/\"===t.charAt(0))}return(c?\"/\":\"\")+(o=r(n(o.split(\"/\"),function(e){return!!e}),!c).join(\"/\"))||\".\"},t.normalize=function(e){var o=t.isAbsolute(e),c=\"/\"===i(e,-1);return(e=r(n(e.split(\"/\"),function(e){return!!e}),!o).join(\"/\"))||o||(e=\".\"),e&&c&&(e+=\"/\"),(o?\"/\":\"\")+e},t.isAbsolute=function(e){return\"/\"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(n(e,function(e){if(\"string\"!=typeof e)throw new TypeError(\"Arguments to path.join must be strings\");return e}).join(\"/\"))},t.relative=function(e,r){function n(e){for(var t=0;t<e.length&&\"\"===e[t];t++);for(var r=e.length-1;0<=r&&\"\"===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=t.resolve(e).substr(1),r=t.resolve(r).substr(1);for(var o=n(e.split(\"/\")),c=n(r.split(\"/\")),i=Math.min(o.length,c.length),a=i,s=0;s<i;s++)if(o[s]!==c[s]){a=s;break}var u=[];for(s=a;s<o.length;s++)u.push(\"..\");return(u=u.concat(c.slice(a))).join(\"/\")},t.sep=\"/\",t.delimiter=\":\",t.dirname=function(e){var t=c(e),r=t[0],n=t[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):\".\"},t.basename=function(e,t){var r=c(e)[2];return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},t.extname=function(e){return c(e)[3]};var i=function(e,t,r){return e.substr(t,r)}}).call(this,r(1))},function(e,t,r){e.exports=function(e,t,n,o){return{FaceDetector:r(9)(e,t,n,o),AsyncFaceDetector:r(10)(e,t,n,o)}}},function(e){e.exports=function(e,t,r,n){return function(o=!1){function c(e){return a.detect(e)}function i(t,r,n=150){const o=r.map(e=>s.predict(t,e));return e.extractImageChips(t,e.getFaceChipDetails(o,n))}const a=new e.FaceDetectorNet(t),s=new e.ShapePredictor(o?n:r);return{locateFaces:c,getFacesFromLocations:i,detectFaces:function(e,t=150){return i(e,c(e).map(e=>e.rect),t)}}}}},function(e){e.exports=function(e,t,r,n){return function(o=!1){function c(e){return a.detectAsync(e)}function i(t,r,n=150){return Promise.all(r.map(e=>s.predictAsync(t,e))).then(r=>e.extractImageChips(t,e.getFaceChipDetails(r,n)))}const a=new e.FaceDetectorNet(t),s=new e.ShapePredictor(o?n:r);return{locateFaces:c,getFacesFromLocations:i,detectFaces:function(e,t=150){return c(e).then(r=>i(e,r.map(e=>e.rect),t))}}}}},function(e,t,r){const{serializeDescriptors:n,toDescriptorState:o,makeLoadDescriptors:c,makeComputeMeanDistance:i,makeGetJitteredFaces:a,makeAddFaceDescriptors:s}=r(0);e.exports=function(e,t){function u(e,t){const r=new e.FaceRecognizerNet(t);let c=[];return{internals:{getNet:()=>r,getDescriptorsByClass:()=>c,addFaceDescriptors:function(e,t){return s(c)(e,t)},computeMeanDistance:l,getJitteredFaces:p},externals:{serialize:function(){return n(c)},load:function(e){c=f(e)},clear:function(){c=[]},getDescriptorState:function(){return o(c)}}}}const f=c(e),l=i(e),p=a(e);return{FaceRecognizer:r(12)(()=>u(e,t)),AsyncFaceRecognizer:r(13)(()=>u(e,t))}}},function(e,t,r){const{flatten:n,serializeDescriptors:o,toDescriptorState:c,makeLoadDescriptors:i,makeComputeMeanDistance:a,makeGetJitteredFaces:s,makeAddFaceDescriptors:u,getBestPrediction:f}=r(0);e.exports=function(e){return function(){function t(e){const t=o().computeFaceDescriptor(e);return c().map(e=>({className:e.className,distance:a(e.faceDescriptors,t)}))}const r=e(),{getNet:o,getDescriptorsByClass:c,addFaceDescriptors:i,computeMeanDistance:a,getJitteredFaces:s}=r.internals;return Object.assign({},r.externals,{addFaces:function(e,t,r=0){if(!e||!e.length)throw new Error(\"train - expected an array containing atleast one face image\");if(!t)throw new Error(\"train - expected a class name\");const c=n(e.map(e=>s(e,r).map(e=>o().computeFaceDescriptor(e))));i(c,t)},getFaceDescriptors:function(e){return o().computeFaceDescriptor(e).getData()},predict:t,predictBest:function(e,r=0){return f(t(e),r)}})}}},function(e,t,r){const{flatten:n,serializeDescriptors:o,toDescriptorState:c,makeLoadDescriptors:i,makeComputeMeanDistance:a,makeGetJitteredFaces:s,makeAddFaceDescriptors:u,getBestPrediction:f}=r(0);e.exports=function(e){return function(){function t(e){return o().computeFaceDescriptorAsync(e).then(e=>c().map(t=>({className:t.className,distance:a(t.faceDescriptors,e)})))}const r=e(),{getNet:o,getDescriptorsByClass:c,addFaceDescriptors:i,computeMeanDistance:a,getJitteredFaces:s}=r.internals;return Object.assign({},r.externals,{addFaces:function(e,t,r=0){if(!e||!e.length)throw new Error(\"train - expected an array containing atleast one face image\");if(!t)throw new Error(\"train - expected a class name\");const c=n(e.map(e=>s(e,r).map(()=>o().computeFaceDescriptorAsync(e))));return Promise.all(c).then(e=>i(e,t))},predict:t,predictBest:function(e,r=0){return t(e).then(e=>f(e,r))}})}}},function(e){e.exports=function(e,t){return{CvImage:function(r){if(!(r instanceof t.Mat))throw new Error(\"CvImage - expected argument to be a cv.Mat\");return new e.CvImageWrap(r.rows,r.cols,r.step,r.elemSize,r.getData())},toCvRect:function(r){if(!(r instanceof e.Rect))throw new Error(\"toCvRect - expected argument to be a fr.Rect\");const{left:n,right:o,bottom:c,top:i}=r;return new t.Rect(n,i,o-n,c-i)}}}}]);","extractedComments":[]}